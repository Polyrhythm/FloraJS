var Flora={},exports=Flora;
(function(c){function b(a){this.el=a||null;Flora.elements=[];Flora.liquids=[];Flora.repellers=[];Flora.attractors=[];Flora.heats=[];Flora.colds=[];Flora.lights=[];Flora.oxygen=[];Flora.food=[];Flora.predators=[];Flora.World=new Flora.World;Flora.World.configure();Flora.elements.push(Flora.World);Flora.Camera=new Flora.Camera;Flora.destroyElement=function(a){var b,e;b=0;for(e=this.elements.length;b<e;b+=1)if(this.elements[b].id===a){Flora.World.el.removeChild(this.elements[b].el);this.elements.splice(b,
1);break}};Flora.interval=setInterval(function(){var a;for(a=Flora.elements.length-1;0<=a;a-=1)Flora.elements[a].step(),Flora.elements[a]&&Flora.elements[a].draw(),Flora.World.clock&&(Flora.World.clock+=1)},16)}b.prototype.start=function(a){a="function"===Flora.Interface.getDataType(a)?a:function(){};a.call()};c.FloraSystem=b})(exports);
(function(c){var b=Math.PI;Utils={inherit:function(a,b){function d(){}d.prototype=b.prototype;a.prototype=new d;a.prototype.constructor=a},map:function(a,b,d,e,g){return(a-b)/(d-b)*(g-e)+e},getRandomNumber:function(a,b,d){return d?Math.random()*(b-(a-1))+a:Math.floor(Math.random()*(b-(a-1)))+a},degreesToRadians:function(a){if("undefined"!==typeof a)return 2*b*(a/360);Log.message("Error: Utils.degreesToRadians is missing degrees param.");return!1},radiansToDegrees:function(a){if("undefined"!==typeof a)return a*
(180/b);Log.message("Error: Utils.radiansToDegrees is missing radians param.");return!1},constrain:function(a,b,d){return a>d?d:a<b?b:a},clone:function(a){function b(){}b.prototype=a;return new b},getUniqueId:function(){return(new Date).getTime()+this.getRandomNumber(0,1E9)},addEvent:function(a,b,d){a.addEventListener?this.addEventHandler=function(a,b,f){a.addEventListener(b,f,!1)}:a.attachEvent&&(this.addEventHandler=function(a,b,f){a.attachEvent("on"+b,f)});this.addEventHandler(a,b,d)}};c.Utils=
Utils})(exports);
(function(c){PVector={PVectorSub:function(b,a){return this.create(b.x-a.x,b.y-a.y)},PVectorAdd:function(b,a){return this.create(b.x+a.x,b.y+a.y)},PVectorMult:function(b,a){return this.create(b.x*a,b.y*a)},PVectorDiv:function(b,a){return this.create(b.x/a.x,b.y/a.y)},PVectorMidPoint:function(b,a){return this.PVectorAdd(b,a).div(2)},PVectorAngleBetween:function(b,a){var f=b.dot(a);return Math.acos(f/(b.mag()*a.mag()))},clone:function(){function b(){}b.prototype=this;return new b},create:function(b,a){function f(){}
var d;f.prototype=this;d=new f;d.x=b;d.y=a;return d},add:function(b){this.x+=b.x;this.y+=b.y;return this},sub:function(b){this.x-=b.x;this.y-=b.y;return this},mult:function(b){this.x*=b;this.y*=b;return this},div:function(b){this.x/=b;this.y/=b;return this},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},limit:function(b){this.mag()>b&&(this.normalize(),this.mult(b))},limitLow:function(b){this.mag()<b&&(this.normalize(),this.mult(b))},normalize:function(){m=this.mag();if(0!==m)return this.div(m)},
distance:function(b){return Math.sqrt(Math.pow(b.x-this.x,2)+Math.pow(b.y-this.y,2))},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},rotate:function(b){var a=Math.cos(b),b=Math.sin(b),f=this.x,d=this.y;this.x=f*a-d*b;this.y=f*b+d*a;return this},midpoint:function(b,a){return this.PVectorAdd(b,a).div(2)},dot:function(b){return this.z&&b.z?this.x*b.x+this.y*b.y+this.z*b.z:this.x*b.x+this.y*b.y}};c.PVector=PVector})(exports);
(function(c){var b={random:function(){return 0.1}};void 0==b&&(b=Math);for(var a=[],f=0;256>f;f+=1)a[f]=Math.floor(256*b.random());b=[];for(f=0;512>f;f+=1)b[f]=a[f&255];SimplexNoise={grad3:[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]],p:a,perm:b,simplex:[[0,1,2,3],[0,1,3,2],[0,0,0,0],[0,2,3,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,3,0],[0,2,1,3],[0,0,0,0],[0,3,1,2],[0,3,2,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,3,2,0],[0,0,0,0],[0,0,0,0],[0,
0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,0,3],[0,0,0,0],[1,3,0,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,3,0,1],[2,3,1,0],[1,0,2,3],[1,0,3,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,3,1],[0,0,0,0],[2,1,3,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,1,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,0,1,2],[3,0,2,1],[0,0,0,0],[3,1,2,0],[2,1,0,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,1,0,2],[0,0,0,0],[3,2,0,1],[3,2,1,0]],dot:function(a,b,f){return a[0]*b+a[1]*f},noise:function(a,
b){var f,c,h;h=0.5*(Math.sqrt(3)-1);h*=a+b;var n=Math.floor(a+h),i=Math.floor(b+h),l=(3-Math.sqrt(3))/6;h=(n+i)*l;f=a-(n-h);var o=b-(i-h),r,q;f>o?(r=1,q=0):(r=0,q=1);c=f-r+l;var p=o-q+l;h=f-1+2*l;var l=o-1+2*l,j=n&255,i=i&255,n=this.perm[j+this.perm[i]]%12;r=this.perm[j+r+this.perm[i+q]]%12;q=this.perm[j+1+this.perm[i+1]]%12;i=0.5-f*f-o*o;0>i?f=0:(i*=i,f=i*i*this.dot(this.grad3[n],f,o));o=0.5-c*c-p*p;0>o?c=0:(o*=o,c=o*o*this.dot(this.grad3[r],c,p));p=0.5-h*h-l*l;0>p?h=0:(p*=p,h=p*p*this.dot(this.grad3[q],
h,l));return 70*(f+c+h)},noise3d:function(a,b,f){var c,h,n,i=(a+b+f)*(1/3),l=Math.floor(a+i),o=Math.floor(b+i),r=Math.floor(f+i),i=1/6;n=(l+o+r)*i;c=a-(l-n);h=b-(o-n);var q=f-(r-n),p,j,t,v,s,w;c>=h?h>=q?(p=1,t=j=0,s=v=1,w=0):(c>=q?(p=1,t=j=0):(j=p=0,t=1),v=1,s=0,w=1):h<q?(j=p=0,t=1,v=0,w=s=1):c<q?(p=0,j=1,v=t=0,w=s=1):(p=0,j=1,t=0,s=v=1,w=0);var u=c-p+i,z=h-j+i,A=q-t+i;n=c-v+2*i;var a=h-s+2*i,B=q-w+2*i,f=c-1+3*i,b=h-1+3*i,i=q-1+3*i,l=l&255,x=o&255,y=r&255,o=this.perm[l+this.perm[x+this.perm[y]]]%
12,r=this.perm[l+p+this.perm[x+j+this.perm[y+t]]]%12;v=this.perm[l+v+this.perm[x+s+this.perm[y+w]]]%12;l=this.perm[l+1+this.perm[x+1+this.perm[y+1]]]%12;s=0.6-c*c-h*h-q*q;0>s?c=0:(s*=s,c=s*s*this.dot(this.grad3[o],c,h,q));h=0.6-u*u-z*z-A*A;0>h?h=0:(h*=h,h=h*h*this.dot(this.grad3[r],u,z,A));u=0.6-n*n-a*a-B*B;0>u?n=0:(u*=u,n=u*u*this.dot(this.grad3[v],n,a,B));a=0.6-f*f-b*b-i*i;0>a?f=0:(a*=a,f=a*a*this.dot(this.grad3[l],f,b,i));return 32*(c+h+n+f)}};c.SimplexNoise=SimplexNoise})(exports);
(function(c){Interface={checkRequiredParams:function(b,a){var f,d,c=!0;for(f in a)if(a.hasOwnProperty(f))try{if(this.getDataType(b[f])!==a[f]||""===b[f])throw c=!1,d=""===b[f]?"Interface.checkRequiredParams: required param '"+f+"' is empty.":"undefined"===typeof b[f]?"Interface.checkRequiredParams: required param '"+f+"' is missing from passed params.":"Interface.checkRequiredParams: passed param '"+f+"' must be type "+a[f]+". Passed as "+this.getDataType(b[f])+".",Error(d);}catch(g){"undefined"!==
typeof console&&console.log("ERROR: "+g.message)}return c},getDataType:function(b){return"[object Array]"===Object.prototype.toString.call(b)?"array":typeof b}};c.Interface=Interface})(exports);
(function(c){var b=function(a){var b=this,a=a||{};this.c=a.c||this.c;this.gravity=a.gravity||this.gravity;this.wind=a.wind||this.wind;this.location=a.location||this.location;this.showStats=a.showStats||this.showStats;this.width=$(window).width();this.height=$(window).height();this.mouseX=this.width/2;this.mouseY=this.height/2;this.isTopDown=!0;this.compassAccuracy=this.compassHeading=0;this.isDeviceMotion=!1;this.showStats&&this.createStats();$(document).mousemove(function(a){b.mouseX=a.pageX;b.mouseY=
a.pageY});window.addEventListener&&this.isDeviceMotion&&window.addEventListener("devicemotion",function(a){b.devicemotion.call(b,a)},!1);window.addEventListener&&this.isDeviceOrientation&&window.addEventListener("deviceorientation",function(a){b.deviceorientation.call(b,a)},!1);$(window).bind("resize",function(){b.resize.call(b)})};b.prototype.configure=function(){this.el=document.body;this.el.style.width=this.width+"px";this.el.style.height=this.height+"px"};b.prototype.update=function(a){var b,
d,a="object"===Interface.getDataType(a)?a:{};for(d in a)a.hasOwnProperty(d)&&(this[d]=a[d]);a.el&&(this.width=parseInt(this.el.style.width.replace("px","")),this.height=parseInt(this.el.style.height.replace("px","")));if(a.style)for(b in a.style)a.style.hasOwnProperty(b)&&(this.el.style[b]=a.style[b]);a.showStats&&this.createStats()};b.prototype.resize=function(){var a,b,d,c=$(window).width(),g=$(window).height();a=0;for(b=Flora.elements.length;a<b;a+=1)if(Flora.elements[a].controlCamera){d=!0;break}if(!d){a=
0;for(b=Flora.elements.length;a<b;a+=1)d=Flora.elements[a].location,d.x=c*(d.x/this.width),d.y=g*(d.y/this.height);this.el===document.body&&(this.width=c,this.height=g)}};b.prototype.devicemotion=function(a){this.gravity=0===window.orientation?this.isTopDown?PVector.create(a.accelerationIncludingGravity.x,-1*a.accelerationIncludingGravity.y):PVector.create(a.accelerationIncludingGravity.x,2*(a.accelerationIncludingGravity.z+7.5)):-90===window.orientation?PVector.create(a.accelerationIncludingGravity.y,
a.accelerationIncludingGravity.x):PVector.create(-1*a.accelerationIncludingGravity.y,-1*a.accelerationIncludingGravity.x)};b.prototype.deviceorientation=function(a){var b=a.webkitCompassHeading;this.compassAccuracy=a=a.webkitCompassAccuracy;this.compassHeading=b;this.showCompassHeading&&$(".console").val("heading: "+b.toFixed(2)+" accuracy: +/- "+a)};b.prototype.createStats=function(){stats=new Stats;stats.getDomElement().style.position="absolute";stats.getDomElement().style.left="0px";stats.getDomElement().style.top=
"0px";stats.getDomElement().id="stats";document.body.appendChild(stats.getDomElement());this.statsInterval=setInterval(function(){stats.update()},1E3/60)};b.prototype.destroyStats=function(){clearInterval(this.statsInterval);document.body.removeChild(document.getElementById("stats"))};b.prototype.step=function(){};b.prototype.draw=function(){var a=this.location.x,b=this.location.y,d=this.width,c=this.height,g=this.el.style;Modernizr.csstransforms3d?(g.webkitTransform="translateX("+a+"px) translateY("+
b+"px) translateZ(0) rotate(0deg) scaleX(1) scaleY(1)",g.MozTransform="translateX("+a+"px) translateY("+b+"px) translateZ(0) rotate(0deg) scaleX(1) scaleY(1)",g.OTransform="translateX("+a+"px) translateY("+b+"px) translateZ(0) rotate(0deg) scaleX(1) scaleY(1)",g.opacity=1,g.width=d+"px",g.height=c+"px"):Modernizr.csstransforms?(g.webkitTransform="translateX("+a+"px) translateY("+b+"px) rotate(0deg) scaleX(1) scaleY(1)",g.MozTransform="translateX("+a+"px) translateY("+b+"px) rotate(0deg) scaleX(1) scaleY(1)",
g.OTransform="translateX("+a+"px) translateY("+b+"px) rotate(0deg) scaleX(1) scaleY(1)",g.opacity=1,g.width=d+"px",g.height=c+"px"):$(this.el).css({position:"absolute",left:a+"px",top:b+"px",width:d+"px",height:c+"px",opacity:1})};b.prototype.showStats=!1;b.prototype.statsInterval=0;b.prototype.clock=0;b.prototype.c=0.01;b.prototype.gravity=PVector.create(0,1);b.prototype.wind=PVector.create(0,0);b.prototype.location=PVector.create(0,0);World=b;c.World=World})(exports);
(function(c){c.Camera=function(b){b=b||{};this.location=b.location||Flora.PVector.create(0,0);this.controlObj=b.controlObj||null}})(exports);
(function(c){function b(){var a,b,c,e;a=0;for(b=arguments.length;a<b;a+=1)for(c in e=arguments[a],e)e.hasOwnProperty(c)&&(this[c]=e[c])}b.events=["mouseenter","mousedown","mousemove","mouseup","mouseleave"];b.mouseenter=function(){this.isMouseOut=!1};b.mousedown=function(a){var b=$(a.target);this.isPressed=!0;this.isMouseOut=!1;this.offsetX=a.pageX-b.position().left;this.offsetY=a.pageY-b.position().top};b.mousemove=function(a){var b,c=$(".world").offset();this.isPressed&&(this.isMouseOut=!1,b=a.pageX-
c.left,a=a.pageY-c.top,this.item.location=PVector.create(b,a))};b.mouseup=function(){this.isPressed=!1};b.mouseleave=function(){var a=this,b=this.item,c,e,g=$(".world").offset();this.isPressed&&(this.isMouseOut=!0,this.mouseOutInterval=setInterval(function(){a.isPressed&&a.isMouseOut&&(c=Flora.World.mouseX-g.left,e=Flora.World.mouseY-g.top,b.location=PVector.create(c,e))},16),$(document).bind("mouseup",function(){a.isPressed=!1}))};b.prototype.draw=function(){var a=this.velocity,b=this.location.x-
this.width/2,c=this.location.y-this.height/2,e=this.scale,g=this.angle,k=this.opacity,h=this.width,n=this.height,i=this.colorMode,l=this.color,o=this.zIndex,r=this.border,q=this.borderRadius,p=this.boxShadow,j=this.el.style,t=this.el.firstChild;a&&t&&(t.style.opacity=Utils.map(a.mag(),0,this.maxSpeed,0.25,1));Modernizr.csstransforms3d?(j.webkitTransform="translateX("+b+"px) translateY("+c+"px) translateZ(0) rotate("+g+"deg) scaleX("+e+") scaleY("+e+")",j.MozTransform="translateX("+b+"px) translateY("+
c+"px) translateZ(0) rotate("+g+"deg) scaleX("+e+") scaleY("+e+")",j.OTransform="translateX("+b+"px) translateY("+c+"px) translateZ(0) rotate("+g+"deg) scaleX("+e+") scaleY("+e+")",j.opacity=k,j.width=h+"px",j.height=n+"px",l&&(j.background=i+"("+l.r+", "+l.g+", "+l.b+")"),j.zIndex=o,j.border=r,j.borderRadius=q,j.boxShadow=p):Modernizr.csstransforms?(j.webkitTransform="translateX("+b+"px) translateY("+c+"px) rotate("+g+"deg) scaleX("+e+") scaleY("+e+")",j.MozTransform="translateX("+b+"px) translateY("+
c+"px) rotate("+g+"deg) scaleX("+e+") scaleY("+e+")",j.OTransform="translateX("+b+"px) translateY("+c+"px) rotate("+g+"deg) scaleX("+e+") scaleY("+e+")",j.opacity=k,j.width=h+"px",j.height=n+"px",j.background=i+"("+l.r+", "+l.g+", "+l.b+")",j.zIndex=o):$(this.el).css({position:"absolute",left:b+"px",top:c+"px",width:h+"px",height:n+"px"})};c.Obj=b})(exports);
(function(c){function b(a){a=a||{};this.id=a.id||"m-"+b.idCount;this.el=a.view&&"function"===Interface.getDataType(a.view)?a.view.call():"object"===Interface.getDataType(a.view)?a.view:document.createElement("div");this.className=a.className||this.className;this.mass=a.mass||this.mass;this.maxSpeed=a.maxSpeed||this.maxSpeed;this.minSpeed=a.minSpeed||this.minSpeed;this.scale=a.scale||this.scale;this.angle=a.angle||this.angle;this.opacity=a.opacity||this.opacity;this.lifespan=a.lifespan||this.lifespan;
this.width=a.width||this.width;this.height=a.height||this.height;this.colorMode=a.colorMode||this.colorMode;this.color=a.color||this.color;this.zIndex=a.zIndex||this.zIndex;this.pointToDirection=a.pointToDirection||this.pointToDirection;this.followMouse=a.followMouse||this.followMouse;this.isStatic=a.isStatic||this.isStatic;this.checkEdges=a.checkEdges||this.checkEdges;this.wrapEdges=a.wrapEdges||this.wrapEdges;this.avoidEdges=a.avoidEdges||this.avoidEdges;this.avoidEdgesStrength=a.avoidEdgesStrength||
this.avoidEdgesStrength;this.bounciness=a.bounciness||this.bounciness;this.maxSteeringForce=a.maxSteeringForce||this.maxSteeringForce;this.flocking=a.flocking||this.flocking;this.desiredSeparation=a.desiredSeparation||this.desiredSeparation;this.separateStrength=a.separateStrength||this.separateStrength;this.alignStrength=a.alignStrength||this.alignStrength;this.cohesionStrength=a.cohesionStrength||this.cohesionStrength;this.sensors=a.sensors||this.sensors;this.flowField=a.flowField||this.flowField;
this.beforeStep=a.beforeStep||this.beforeStep;this.afterStep=a.afterStep||this.afterStep;this.acceleration=a.acceleration||c.PVector.create(0,0);this.velocity=a.velocity||c.PVector.create(0,0);this.location=a.location||c.PVector.create(Flora.World.width/2,Flora.World.height/2);c.elements.push(this);c.World.el.appendChild(this.el);b.idCount+=1}c.Utils.inherit(b,c.Obj);b.create=function(a){var f=a||{};f.id=f.id||"m-"+b.idCount;f.el=f.view&&"function"===Interface.getDataType(f.view)?f.view.call():"object"===
Interface.getDataType(f.view)?f.view:document.createElement("div");a=new this(f);a.el.id=f.id;a.el.className=a.className;Flora.elements.push(a);Flora.World.el.appendChild(a.el);"liquid"===a.className?Flora.liquids.push(a):"repeller"===a.className?Flora.repellers.push(a):"attractor"===a.className?Flora.attractors.push(a):"heat"===a.className?Flora.heats.push(a):"cold"===a.className?Flora.colds.push(a):"predator"===a.className?Flora.predators.push(a):"light"===a.className?Flora.lights.push(a):"oxygen"===
a.className?Flora.oxygen.push(a):"food"===a.className&&Flora.food.push(a);b.idCount+=1;a.controlCamera&&(Flora.Camera.controlObj=a,Flora.World.location.x=-Flora.World.width/2+$(window).width()/2+(Flora.World.width/2-a.location.x),Flora.World.location.y=-Flora.World.height/2+$(window).height()/2+(Flora.World.height/2-a.location.y));return Flora.elements[Flora.elements.length-1]};b.idCount=0;b.prototype.step=function(){var a,b,d,e=Flora.World;this.beforeStep&&this.beforeStep.apply(this);if(!this.isStatic&&
!this.isPressed){if(0<Flora.liquids.length){a=0;for(b=Flora.liquids.length;a<b;a+=1)this.id!==Flora.liquids[a].id&&this.isInside(Flora.liquids[a])&&(d=this.drag(Flora.liquids[a]),this.applyForce(d))}if(0<Flora.repellers.length){a=0;for(b=Flora.repellers.length;a<b;a+=1)this.id!==Flora.repellers[a].id&&(d=this.attract(Flora.repellers[a]),this.applyForce(d))}if(0<Flora.attractors.length){a=0;for(b=Flora.attractors.length;a<b;a+=1)this.id!==Flora.attractors[a].id&&(d=this.attract(Flora.attractors[a]),
this.applyForce(d))}if(0<this.sensors.length){a=0;for(b=this.sensors.length;a<b;a+=1){d=this.sensors[a];var g=d.length,k=Utils.degreesToRadians(this.angle+d.offsetAngle),h=g*Math.cos(k),g=g*Math.sin(k);d.location.x=this.location.x;d.location.y=this.location.y;d.location.add(c.PVector.create(h,g));d.activated&&this.applyForce(d.getActivationForce({mover:this}))}}e.c&&(a=Utils.clone(this.velocity),a.mult(-1),a.normalize(),a.mult(e.c),this.applyForce(a));this.applyForce(e.wind);this.applyForce(e.gravity);
this.followMouse&&(a={location:c.PVector.create(e.mouseX,e.mouseY)},this.applyForce(this.seek(a)));this.target&&this.applyForce(this.seek(this.target));this.flowField&&(b=this.flowField.resolution,a=Math.floor(this.location.x/b),b=Math.floor(this.location.y/b),this.flowField.field[a]&&(a=(a=this.flowField.field[a][b])?{location:c.PVector.create(a.x,a.y)}:{location:c.PVector.create(this.location.x,this.location.y)},this.applyForce(this.follow(a))));this.flocking&&this.flock(Flora.elements);this.velocity.add(this.acceleration);
this.maxSpeed&&this.velocity.limit(this.maxSpeed);this.minSpeed&&this.velocity.limitLow(this.minSpeed);this.location.add(this.velocity);this.pointToDirection&&0.1<this.velocity.mag()&&(this.angle=Utils.radiansToDegrees(Math.atan2(this.velocity.y,this.velocity.x)));this.controlCamera&&this.checkCameraEdges();(this.checkEdges||this.wrapEdges)&&this.checkWorldEdges(e);this.parent&&(this.location=this.parent.location);this.afterStep&&this.afterStep.apply(this);this.acceleration.mult(0);0<this.lifespan&&
(this.lifespan-=1)}};b.prototype.applyForce=function(a){a=a.clone();a.div(this.mass);this.acceleration.add(a)};b.prototype.seek=function(a){var b=Flora.World,a=c.PVector.PVectorSub(a.location,this.location),d=a.mag();a.normalize();d<b.width/2?(b=Utils.map(d,0,b.width/2,0,this.maxSpeed),a.mult(b)):a.mult(this.maxSpeed);b=c.PVector.PVectorSub(a,this.velocity);b.limit(this.maxSteeringForce);return b};b.prototype.follow=function(a){a=a.location;a.mult(this.maxSpeed);a=c.PVector.PVectorSub(a,this.velocity);
a.limit(this.maxSteeringForce);return a};b.prototype.flock=function(a){this.applyForce(this.separate(a).mult(this.separateStrength));this.applyForce(this.align(a).mult(this.alignStrength));this.applyForce(this.cohesion(a).mult(this.cohesionStrength))};b.prototype.separate=function(a){var b,d,e,g,k=c.PVector.create(0,0),h=0;b=0;for(d=a.length;b<d;b+=1)e=a[b],this.className===e.className&&this.id!==e.id&&(g=this.location.distance(e.location),0<g&&g<this.desiredSeparation&&(e=c.PVector.PVectorSub(this.location,
e.location),e.normalize(),e.div(g),k.add(e),h+=1));return 0<h?(k.div(h),k.normalize(),k.mult(this.maxSpeed),a=c.PVector.PVectorSub(k,this.velocity),a.limit(this.maxSteeringForce),a):c.PVector.create(0,0)};b.prototype.align=function(a){var b,d,e,g,k=c.PVector.create(0,0),h=2*this.width,n=0;b=0;for(d=a.length;b<d;b+=1)e=a[b],g=this.location.distance(e.location),0<g&&g<h&&(this.className===e.className&&this.id!==e.id)&&(k.add(e.velocity),n+=1);return 0<n?(k.div(n),k.normalize(),k.mult(this.maxSpeed),
a=c.PVector.PVectorSub(k,this.velocity),a.limit(this.maxSteeringForce),a):c.PVector.create(0,0)};b.prototype.cohesion=function(a){var b,d,e,g,k=c.PVector.create(0,0),h=0;b=0;for(d=a.length;b<d;b+=1)e=a[b],g=this.location.distance(e.location),0<g&&10>g&&(this.className===e.className&&this.id!==e.id)&&(k.add(e.location),h+=1);return 0<h?(k.div(h),a=c.PVector.PVectorSub(k,this.location),a.normalize(),a.mult(this.maxSpeed),a=c.PVector.PVectorSub(a,this.velocity),a.limit(this.maxSteeringForce),a):c.PVector.create(0,
0)};b.prototype.flee=function(a){a=c.PVector.PVectorSub(a.location,this.location);a.normalize();a.mult(-this.maxSpeed);return a};b.prototype.drag=function(a){var b=this.velocity.mag(),a=-1*a.c*b*b,b=Utils.clone(this.velocity);b.normalize();b.mult(a);return b};b.prototype.attract=function(a){var b=c.PVector.PVectorSub(a.location,this.location),d;d=b.mag();d=Utils.constrain(d,a.mass/4,a.mass/2);b.normalize();b.mult(a.G*a.mass*this.mass/(d*d));return b};b.prototype.isInside=function(a){return a&&this.location.x+
this.width/2>a.location.x-a.width/2&&this.location.x-this.width/2<a.location.x+a.width/2&&this.location.y+this.height/2>a.location.y-a.height/2&&this.location.y-this.height/2<a.location.y+a.height/2?!0:!1};b.prototype.checkWorldEdges=function(a){var b=this.location.x,d=this.location.y,e,g=!1,k;this.wrapEdges?this.location.x>a.width?(this.location=c.PVector.create(0,this.location.y),k=c.PVector.create(b-this.location.x,0),g=!0):0>this.location.x&&(this.location=c.PVector.create(a.width,this.location.y),
k=c.PVector.create(b-this.location.x,0),g=!0):(this.avoidEdges&&(this.location.x<this.avoidEdgesStrength?e=this.maxSpeed:this.location.x>Flora.World.width-this.avoidEdgesStrength&&(e=-this.maxSpeed),e&&(e=c.PVector.create(e,this.velocity.y),e=c.PVector.PVectorSub(e,this.velocity),e.limit(this.maxSteeringForce),this.applyForce(e))),this.location.x+this.width/2>a.width)?(this.location=c.PVector.create(a.width-this.width/2,this.location.y),k=c.PVector.create(b-this.location.x,0),this.velocity.x*=-1*
this.bounciness,g=!0):this.location.x<this.width/2&&(this.location=c.PVector.create(this.width/2,this.location.y),k=c.PVector.create(b-this.location.x,0),this.velocity.x*=-1*this.bounciness,g=!0);e=null;this.wrapEdges?this.location.y>a.height?(this.location=c.PVector.create(this.location.x,0),k=c.PVector.create(0,d-this.location.y),g=!0):0>this.location.y&&(this.location=c.PVector.create(this.location.x,a.height),k=c.PVector.create(0,d-this.location.y),g=!0):(this.avoidEdges&&(this.location.y<this.avoidEdgesStrength?
e=this.maxSpeed:this.location.y>Flora.World.height-this.avoidEdgesStrength&&(e=-this.maxSpeed),e&&(e=c.PVector.create(this.velocity.x,e),e=c.PVector.PVectorSub(e,this.velocity),e.limit(this.maxSteeringForce),this.applyForce(e))),this.location.y+this.height/2>a.height)?(this.location=c.PVector.create(this.location.x,a.height-this.height/2),k=c.PVector.create(0,d-this.location.y),this.velocity.y*=-1*this.bounciness,g=!0):this.location.y<this.height/2&&(this.location=c.PVector.create(this.location.x,
this.height/2),k=c.PVector.create(0,d-this.location.y),this.velocity.y*=-1*this.bounciness,g=!0);g&&this.controlCamera&&Flora.World.location.add(k);return g};b.prototype.checkCameraEdges=function(){var a=this.velocity.clone();Flora.World.location.add(a.mult(-1))};b.prototype.getLocation=function(a){if(a){if("x"===a)return this.location.x;if("y"===a)return this.location.y}else return c.PVector.create(this.location.x,this.location.y)};b.prototype.getVelocity=function(a){if(a){if("x"===a)return this.velocity.x;
if("y"===a)return this.velocity.y}else return c.PVector.create(this.velocity.x,this.velocity.y)};b.prototype.className="mover";b.prototype.mass=10;b.prototype.maxSpeed=10;b.prototype.minSpeed=0;b.prototype.scale=1;b.prototype.angle=0;b.prototype.opacity=0.85;b.prototype.lifespan=-1;b.prototype.width=20;b.prototype.height=20;b.prototype.colorMode="rgb";b.prototype.color={r:197,g:177,b:115};b.prototype.zIndex=10;b.prototype.pointToDirection=!0;b.prototype.followMouse=!1;b.prototype.isStatic=!1;b.prototype.checkEdges=
!0;b.prototype.wrapEdges=!1;b.prototype.avoidEdges=!1;b.prototype.avoidEdgesStrength=200;b.prototype.bounciness=0.75;b.prototype.maxSteeringForce=10;b.prototype.flocking=!1;b.prototype.desiredSeparation=2*b.prototype.width;b.prototype.separateStrength=1;b.prototype.alignStrength=1;b.prototype.cohesionStrength=1;b.prototype.sensors=[];b.prototype.flowField=null;b.prototype.beforeStep="";b.prototype.afterStep="";c.Mover=b})(exports);
