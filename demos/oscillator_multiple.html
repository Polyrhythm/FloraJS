<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
  <meta name="viewport" content = "user-scalable=no, width=device-width, initial-scale=1.0; maximum-scale=1.0;" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <title>Flora</title>
  <link rel="stylesheet" href="css/flora.css" type="text/css" charset="utf-8">
  <script src="lib/jquery.min.js" type="text/javascript" charset="utf-8"></script>
  <script src="lib/modernizr.js" type="text/javascript" charset="utf-8"></script>
  <script src="../build/build.js" type="text/javascript" charset="utf-8"></script>
</head>
<body>
    <script type="text/javascript" charset="utf-8">

      var system = new exports.FloraSystem();

      system.start(function () {

        Flora.universe.update({
          color: [255, 255, 255]
        });

        var osc = [],
            max = 100,
            show = 1;

        var pt = new Flora.Point();

        for (var i = 0; i < max; i++) {

          osc.push(new Flora.Oscillator({
            amplitude: new Flora.Vector(Flora.universe.first().width/2 - 50, Flora.universe.first().height/2 - 50),
            acceleration: new Flora.Vector(Flora.Utils.map(i, 0, max, 0.025, 0.03),
                Flora.Utils.map(i, 0, max, 0.035, 0.04)),
            pointToDirection: true,
            width: Flora.Utils.map(i, 0, max, 1, 40),
            height: Flora.Utils.map(i, 0, max, 1, 25),
            opacity: Flora.Utils.map(i, 0, max, .1, 1)
          }));

          if (i % 10  === 0) {
            var connector = new exports.Connector({
              parentA: pt,
              parentB: osc[osc.length - 1],
              borderColor: [150, 150, 150]
            });
          }
        }


        var toggleConectors = function() {

          var opacity = 0;

          show *= -1;

          if (show > 0) {
            opacity = 1;
          }

          Flora.elementList.updatePropsByClass('Connector', {
            opacity: opacity
          });
        };

        var caption = new Flora.Caption({
          text: '\'c\' = toggle connectors',
          opacity: 0.4,
          borderColor: 'transparent',
          position: 'bottom center'
        });

        Flora.Utils.addEvent(document, 'keyup', function(e) {
          'use strict';

          if (e.keyCode === 67) { // 'c'
            toggleConectors();
          }
        });

      });
  </script>
</body>
</html>